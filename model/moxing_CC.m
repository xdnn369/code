GDP = [6198.21, 7759.45, 8827.20, 9729.38, 10700.52, 11455.71, 12559.82, 14120.12, 16122.73, 17492.38, 18385.77];
NOx = [211.7535, 219.8885, 231.2751, 227.3143, 214.7103, 204.0944, 196.3559, 191.6953, 187.6683, 183.0575, 173.3192]*448*12;
PM10 = [186.5676, 176.6986, 176.3333, 167.4231, 153.1331, 138.094, 122.9401, 114.4706, 104.5831, 99.75909, 92.38957]*448*12;
PM25 = [137.9454, 130.5915, 129.0357, 120.8866, 112.3823, 103.0199, 94.47189, 88.38704, 81.28024, 77.9324, 72.69312]*448*12;
SO2 = [423.9638, 433.232, 447.4058, 407.6285, 306.989, 237.0381, 187.0147, 148.1375, 106.9549, 91.94138, 83.13609]*448*12;
VOC = [286.9745, 296.0299, 299.3253, 300.2199, 303.8161, 317.2034, 328.2599, 325.2101, 321.8946, 310.0437, 292.5713]*448*12;

N = 91000000;

PGDP = GDP/0.91;  %人均GDP（元/人）
PNOx = NOx*1000/N;  %人均NOx（千克/人）
PPM10 = PM10*1000/N;
PPM25 = PM25*1000/N;
PSO2 = SO2*1000/N;
PVOC = VOC*1000/N;

% 取对数  
LPGDP = log(PGDP);  
LPNOx1 = log(PNOx);  
LPPM101 = log(PPM10);  
LPPM251 = log(PPM25);  
LPSO21 = log(PSO2);  
LPVOC1 = log(PVOC); 

%LPGDP = log(PGDP);  
LPNOx2 = (log(PNOx)).^2;  
LPPM102 = (log(PPM10)).^2;  
LPPM252 = (log(PPM25)).^2;  
LPSO22 = (log(PSO2)).^2;  
LPVOC2 = (log(PVOC)).^2; 

%LPGDP = log(PGDP);  
LPNOx3 = (log(PNOx)).^3;  
LPPM103 = (log(PPM10)).^3;  
LPPM253 = (log(PPM25)).^3;  
LPSO23 = (log(PSO2)).^3;  
LPVOC3 = (log(PVOC)).^3; 

% 创建表格数据  
%tbl = table(LPGDP', LPNOx1', LPPM101', LPPM251', LPSO21', LPVOC1', 'VariableNames', {'LPGDP', 'LPNOx1', 'LPPM101', 'LPPM251', 'LPSO21', 'LPVOC1'});
%tbl = table(LPGDP', LPNOx2', LPPM102', LPPM252', LPSO22', LPVOC2', 'VariableNames', {'LPGDP', 'LPNOx2', 'LPPM102', 'LPPM252', 'LPSO22', 'LPVOC2'});
%tbl = table(LPGDP', LPNOx3', LPPM103', LPPM253', LPSO23', LPVOC3', 'VariableNames', {'LPGDP', 'LPNOx3', 'LPPM103', 'LPPM253', 'LPSO23', 'LPVOC3'});
%tbl = table(LPGDP', LPNOx1', LPPM101', LPPM251', LPSO21', LPVOC1', LPNOx2', LPPM102', LPPM252', LPSO22', LPVOC2', 'VariableNames', {'LPGDP', 'LPNOx1', 'LPPM101', 'LPPM251', 'LPSO21', 'LPVOC1', 'LPNOx2', 'LPPM102', 'LPPM252', 'LPSO22', 'LPVOC2'});
%tbl = table(LPGDP', LPNOx1', LPPM101', LPPM251', LPSO21', LPVOC1', LPNOx3', LPPM103', LPPM253', LPSO23', LPVOC3', 'VariableNames', {'LPGDP', 'LPNOx1', 'LPPM101', 'LPPM251', 'LPSO21', 'LPVOC1', 'LPNOx3', 'LPPM103', 'LPPM253', 'LPSO23', 'LPVOC3'});
%tbl = table(LPGDP', LPNOx2', LPPM102', LPPM252', LPSO22', LPVOC2', LPNOx3', LPPM103', LPPM253', LPSO23', LPVOC3', 'VariableNames', {'LPGDP', 'LPNOx2', 'LPPM102', 'LPPM252', 'LPSO22', 'LPVOC2', 'LPNOx3', 'LPPM103', 'LPPM253', 'LPSO23', 'LPVOC3'});
%tbl = table(LPGDP', LPNOx1', LPPM101', LPPM251', LPSO21', LPVOC1', LPNOx2', LPPM102', LPPM252', LPSO22', LPVOC2', LPNOx3', LPPM103', LPPM253', LPSO23', LPVOC3', %'VariableNames', {'LPGDP', 'LPNOx1', 'LPPM101', 'LPPM251', 'LPSO21', 'LPVOC1', 'LPNOx2', 'LPPM102', 'LPPM252', 'LPSO22', 'LPVOC2', 'LPNOx3', 'LPPM103', 'LPPM253', 'LPSO23', 'LPVOC3'});  
%tbl = table(LPGDP', LPSO21', LPNOx2', LPPM102', LPPM252', LPSO22', LPVOC2', LPNOx3', LPPM103', LPPM253', 'VariableNames', {'LPGDP', 'LPSO21', 'LPNOx2', 'LPPM102', 'LPPM252', 'LPSO22', 'LPVOC2', 'LPNOx3', 'LPPM103', 'LPPM253'});  
tbl = table(LPGDP', LPNOx1', LPVOC1', LPNOx2', LPVOC2', 'VariableNames', {'LPGDP', 'LPNOx1', 'LPVOC1', 'LPNOx2', 'LPVOC2'});
%tbl = table(LPGDP', LPNOx1', LPVOC1', LPNOx3', LPVOC3', 'VariableNames', {'LPGDP', 'LPNOx1', 'LPVOC1', 'LPNOx3', 'LPVOC3'});
%tbl = table(LPGDP', LPNOx2', LPVOC2', LPNOx3', LPVOC3', 'VariableNames', {'LPGDP', 'LPNOx2', 'LPVOC2', 'LPNOx3', 'LPVOC3'});
%tbl = table(LPGDP', LPNOx1', LPSO21', LPVOC1', LPNOx2', LPSO22', LPVOC2', LPNOx3', LPSO23', LPVOC3', 'VariableNames', {'LPGDP', 'LPNOx1', 'LPSO21', 'LPVOC1', 'LPNOx2', 'LPSO22', 'LPVOC2', 'LPNOx3', 'LPSO23', 'LPVOC3'});
%tbl = table(LPGDP', LPNOx1', LPSO21', LPVOC1', LPNOx2', LPSO22', LPVOC2', 'VariableNames', {'LPGDP', 'LPNOx1', 'LPSO21', 'LPVOC1', 'LPNOx2', 'LPSO22', 'LPVOC2'});
%tbl = table(LPGDP', LPNOx2', LPSO22', LPVOC2', LPNOx3', LPSO23', LPVOC3', 'VariableNames', {'LPGDP', 'LPNOx2', 'LPSO22', 'LPVOC2', 'LPNOx3', 'LPSO23', 'LPVOC3'});
%tbl = table(LPGDP', LPNOx1', LPSO21', LPVOC1', LPNOx3', LPSO23', LPVOC3', 'VariableNames', {'LPGDP', 'LPNOx1', 'LPSO21', 'LPVOC1', 'LPNOx3', 'LPSO23', 'LPVOC3'});

% 使用 fitlm 进行多元线性回归
%mdl = fitlm(tbl, 'LPGDP ~ LPNOx1 + LPPM101 + LPPM251 + LPSO21 + LPVOC1');
%mdl = fitlm(tbl, 'LPGDP ~ LPNOx2 + LPPM102 + LPPM252 + LPSO22 + LPVOC2');
%mdl = fitlm(tbl, 'LPGDP ~ LPNOx3 + LPPM103 + LPPM253 + LPSO23 + LPVOC3');
%mdl = fitlm(tbl, 'LPGDP ~ LPNOx1 + LPPM101 + LPPM251 + LPSO21 + LPVOC1 + LPNOx2 + LPPM102 + LPPM252 + LPSO22 + LPVOC2'); 
%mdl = fitlm(tbl, 'LPGDP ~ LPNOx1 + LPPM101 + LPPM251 + LPSO21 + LPVOC1 + LPNOx3 + LPPM103 + LPPM253 + LPSO23 + LPVOC3');  
%mdl = fitlm(tbl, 'LPGDP ~ LPNOx2 + LPPM102 + LPPM252 + LPSO22 + LPVOC2 + LPNOx3 + LPPM103 + LPPM253 + LPSO23 + LPVOC3');
%mdl = fitlm(tbl, 'LPGDP ~ LPNOx1 + LPPM101 + LPPM251 + LPSO21 + LPVOC1 + LPNOx2 + LPPM102 + LPPM252 + LPSO22 + LPVOC2 + LPNOx3 + LPPM103 + LPPM253 + LPSO23 + LPVOC3'); 
%mdl = fitlm(tbl, 'LPGDP ~ LPSO21 + LPNOx2 + LPPM102 + LPPM252 + LPSO22 + LPVOC2 + LPNOx3 + LPPM103 + LPPM253');
mdl = fitlm(tbl, 'LPGDP ~ LPNOx1 + LPVOC1 + LPNOx2 + LPVOC2');
%mdl = fitlm(tbl, 'LPGDP ~ LPNOx1 + LPVOC1 + LPNOx3 + LPVOC3');
%mdl = fitlm(tbl, 'LPGDP ~ LPNOx2 + LPVOC2 + LPNOx3 + LPVOC3');
%mdl = fitlm(tbl, 'LPGDP ~ LPNOx1 + LPSO21 + LPVOC1 + LPNOx2 + LPSO22 + LPVOC2 + LPNOx3 + LPSO23 + LPVOC3');
%mdl = fitlm(tbl, 'LPGDP ~ LPNOx1 + LPSO21 + LPVOC1 + LPNOx2 + LPSO22 + LPVOC2');
%mdl = fitlm(tbl, 'LPGDP ~ LPNOx2 + LPSO22 + LPVOC2 + LPNOx3 + LPSO23 + LPVOC3');
%mdl = fitlm(tbl, 'LPGDP ~ LPNOx1 + LPSO21 + LPVOC1 + LPNOx3 + LPSO23 + LPVOC3');

% 显示回归结果  
disp(mdl);  

% 显示系数和 p 值  
disp('回归系数和 p 值：');  
disp(mdl.Coefficients);  

% 显示调整后的 R² 值  
disp(['调整后的 R²：', num2str(mdl.Rsquared.Adjusted)]);  